<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>加密的HTML文件</title>
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            font-family: Arial, sans-serif;
            background: #f5f5f5;
        }
        .decrypt-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .decrypt-box {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        .decrypt-box h2 {
            margin-bottom: 20px;
        }
        .decrypt-box p {
            margin-bottom: 20px;
            opacity: 0.9;
        }
        .decrypt-input {
            width: 100%;
            padding: 12px;
            margin: 10px 0 20px;
            border: none;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.9);
            font-size: 16px;
        }
        .decrypt-btn {
            padding: 12px 30px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }
        .decrypt-btn:hover {
            background: #45a049;
        }
        .hidden {
            display: none !important;
        }
        #contentContainer {
            all: initial !important;
        }
        .domain-warning {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #c62828;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 999999;
            text-align: center;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        .domain-warning h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: #ffcdd2;
        }
        .domain-warning p {
            font-size: 1.2rem;
            margin-bottom: 10px;
            max-width: 800px;
        }
        .domain-warning .current-domain {
            color: #ffcdd2;
            font-weight: bold;
            background: rgba(0,0,0,0.3);
            padding: 5px 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .domain-warning .allowed-domain {
            color: #c8e6c9;
            font-weight: bold;
            background: rgba(0,0,0,0.3);
            padding: 5px 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .debug-info {
            font-size: 0.9rem;
            background: rgba(0,0,0,0.5);
            padding: 10px;
            border-radius: 5px;
            margin-top: 20px;
            text-align: left;
            max-width: 800px;
        }
    </style>
</head>
<body>
    <div id="domainWarning" class="domain-warning hidden">
        <h1>盗版警告！</h1>
        <p>此HTML文件只能在指定的授权域名下运行。</p>
        <p>当前域名：<span id="currentDomainDisplay" class="current-domain"></span></p>
        <p>授权域名：<span id="allowedDomainDisplay" class="allowed-domain"></span></p>
        <div id="debugInfo" class="debug-info"></div>
        <p style="margin-top: 30px; font-size: 1rem; opacity: 0.8;">如需正常使用，请联系文件作者获取授权版本。</p>
    </div>

    <div id="decryptPrompt" class="decrypt-container">
        <div class="decrypt-box">
            <h2>需要密码查看源代码</h2>
            <p>此HTML文件已加密。要查看源代码，请输入密码：</p>
            <input type="password" id="decryptPassword" class="decrypt-input" placeholder="输入密码">
            <button id="showSourceBtn" class="decrypt-btn">显示源代码</button>
            <p style="font-size: 14px; margin-top: 20px; opacity: 0.7;">注意：此页面内容可以正常浏览，无需密码。</p>
        </div>
    </div>

    <div id="contentContainer" class="hidden"></div>

    <script>
        // 域名验证和加密的数据
        const allowedDomainKey = 1280;
        const allowedDomain = "gz.whx11258.xyz";
        const encryptedData = "yaTJuMieyJTIn8iJyIfIj8ilyYHIisiXyInIicmYya3JlMiByJ7IhsiAyZPJpMmTyJjIlMiTyJfJism/yYrImsidyI3Im8mbyJ/IlcifyI3Ls8uky7bKvsqmy7DLssuhyqXKscqoyrXKrMqHyrLLu8u5y6XLvsu2yqrohYnpsonmn47nopPKscuoy67Lssuyy7HLvcqOy4LLjcuOyo3KmcqJy5PLgcudy4bLjsqSyo3KpMqTy4PLhcuLy5/LkcqLyrzKmcuey5bLlcuPy5nLj8qey4TLisuhy6LKocqlyqbKrcqgyrrKpsq/yqXKqMugyq3KoMq8yr7KoMupy7TLtsqQy6bKnsuoypzLqsuny5fLvsu/ypTKhMqaypfLicqEyorKjsqPyofLkMuLyo/KiMqAypvKlcqDy4nLucuUy5XKhsqWypzKncqTypXKm8uHy57LjsywzbHNusy4zI7NuMyMzKnNoM2szavNr82pzb/MhM20zJrMmM2/zbrNusy4zb7Nss2xzb7Nss2vzKbMr8yuza/NmMyazKjMqs2GzYTNhc2MzY/Nm82FzZ7Ngs2JzIPNjM2fzZ3Nnc2BzI7Nh82RzZXMkMyNzI/Ml8yczIzMjcyOzazNoc2zzbvNvc2szabNvM2CzanNqs2rzazMucyrzLfMpM28zLPMv8y9zLLMuM2tybjIusi/yLXIqMi4yKzJpMmqyYHJgsmDya7JhcmGyYfJosmjyJfJocmCyIXIi8iOyJTIlMiAyYLJvsiOybzJvsiVyJDIlMmWyJTImMiXyJjLqMu1yrjKu8qwyrXLtsu/yrPKg8qDy6nLrcuuy6XLqMuiy77Lp8u9y7DKuMu1y7jLtMu2y6jKocuuy7rLvMq3ypHKk8qQyo/KhMqUypPKk8qEyonKm8qcypnKhMqOypTKusqRypLKk8qUy4HLk8uPy4zKlMuby5fLlcuay5DKhcugyqLKp8qtyrDKoMq0y7zLgsupy6rLq8usyrrKocq9yrTLvMqhyqPKtcq2yr/Kucq/y6PLusupy6zKrcqmy6TLqsuBy4LLg8uEyonKj8qJyo3LhMqCyo7KhcqKyobKm8uKy5HLh8uDy4TKhcqOy4zLssuzyofLscuSypXKm8qezaTNpM2wzKPNt82xzbTNqM2mza7NscyBzKzMrcyuzK/Ns82+zb7NvM2mzK/Mtsy0zb7Mq828zKnNusyvzKXMlc2dzKvMjM2XzYvNlc2IzYbNnsyJzZHMocyMzI3Ngc2ZzZXNg82UzZ/Nm82CzIzMl82QzZDNns2fzZnNk8yFzLXNoM2hzKDMosynzK7Mocy1zKfMvMykzK/NocyuzKHMo8y/zKPNqM2zzKbMssy0zb/JrMmsybbJu8mtya7Jr8mzyYDJkMmayZrJjcmeyazImsmiyYnJoMmhyYLImciByJ/InsiQyITJk8iVyZXIjcm9yZjJmcicyJfIk8icyIrJhcqgy63Lp8uly7DKvsqMyqfKqMuty6PLuMu8y6HLr8u2yqrKscuwy7/Lu8u2y73KrMqSyrnKusu4y7PLscuxy63KmsqByoHLhcqWy4PKlMuByprKksqgyovKjMuZy4vLl8uEypzLk8ufy53LksuYyo3KmMuay5/LlcuIy5jLjMqEy4rLocuiyrPKpcqhyqLKrsqmyq7LsMury73Lucq+yrfLsMugy6TKo8qsy67LnMu3y7jKrcq/yqPKqMuwyrrKusqDyo7KkMqCypDKjMqJyonLksuJyoTKhMqCyojLlculyo3Lu8uSy7nLvsubyoLKmMqIypfKm8qNy5zKnMuEypfNr823zafNscykzb7MjMynzKjNq82rzajNp82qzbzNoM2lzb/Ntsy+zbfNus26zbjNqsyjzLrMuM24zbnNusykzKrMgcyCzYDNi82JzYnNlcySzInNiM2HzY3Njs2FzJTMus2MzLjMucyIzJrNhc2DzYHNlc2fzIXMtsyBzJHNl8ylzKDMps29zY7Nj826zKXMp8ytzLPNtc2GzbHMqsymzKbNscyxzL/MtcymzKXNqsm6yLHIv8i6yLjIuMisyb3JnsmryYLJn8iXyJHIlMiIyIbIjsmUyJzIhMiVyZ/JnsmCyYTJismPyZvIhsiCyIXIl8iXyJ3Jhcm2yZ3JnsmfyqDKi8q+yqzLoMusy7DKucqCyrXLrsuiy7rKrcuty6PLscuiy6HKrsq2y6HLucuny7bLuMusyrnKosqXyr7Kv8qcy4DKgsuLy5bLgMuAyprKisuBy57Ln8ucypfKgcqAy4fLmcuKyoLKhcqHyoPKj8qWy4HLg8uByp7Kg+SyhemriumWosu9y63Kosu6y4/Lpsuny7TKqMuqyqPKvsqoyqjLssuyyrnKpsqnyqTLr8u5y7jKv8qjy7TKrMq0yqXLr8uuy5LLlMuay43KnMqcypzLiMqJyoDLnMuFyovKhMqayofKhcqTy5zKmsqby5rLlMuJ5Yai5aWby4bLlMqdy4PLtMufzKDMvc2jzKPNrM23zaPNocy1zKvNos2/zbjNvcy0zKDMv822zajMvc2jzb3NrsymzKnMq8yvzKPMss2lzafNpcyPzZbNjc2RzY/Mi82BzY7NnM2BzZ/NicyCzYTNgcyAzJLMj+S0ueixjuenrcyJzJnNlsyGzLPMhsyUzZjNlM2IzIHNis29zKbMqsyyzaXMpcyrzKnMusy5zbbNrsylzKvMrsy0zLTMoM2izbbNq82czbfJpMiqyK7IqcizyLPIucmh6La55pGO5oGz55On5LGO5LOf57S356K+77Wk5ouB5YaF5LKO5ZWE6La06Y6i5oCR5YGA5oGg55O25YSp5aeW44m06aiP55KZ5Zu06Iit57qB5Laa5oiT44m/yYLJkMuzy7XLsMusy6rLosq4yo3KtMqmy67Losu6yrPKhMqzy7TLuMukyrPLt8u5y7fLpMuryqTKuMu9y7PLssuqy7rLksqDypzKqcqEyoXKmsuXypbLqsuFy5vLlcufy4fLiMuYy4XKksiaypTKh8qGyoXKjMqZy43Lk8uEyozKj8qNy7XLucusyrvKvcq/y6bKhsqkyqXLqsqZyqXKqsqmyrvKo8uxyoDKtsqnyrDKpMqhyr3Kvcumy7TKrMujy5TLo8uPyoXKi8qVy5rLr8uay4jKisqGyo7KksuSy6fLksuAypjKhcqfyp/Lig==";
        const passwordKey = 600;
        
        // 域名验证函数
        function validateDomain() {
            try {
                // 获取当前域名（不包含端口和协议）
                let currentDomain = window.location.hostname.toLowerCase();
                
                // 移除www.前缀进行统一比较
                currentDomain = currentDomain.replace(/^www\./, '');
                let allowedDomainClean = allowedDomain.toLowerCase().replace(/^www\./, '');
                
                // 调试信息
                let debugHtml = '<strong>调试信息：</strong><br>';
                debugHtml += '原始当前域名: ' + window.location.hostname + '<br>';
                debugHtml += '处理后的当前域名: ' + currentDomain + '<br>';
                debugHtml += '原始授权域名: ' + allowedDomain + '<br>';
                debugHtml += '处理后的授权域名: ' + allowedDomainClean + '<br>';
                debugHtml += '当前域名密钥: ' + Array.from(currentDomain).reduce((sum, char) => sum + char.charCodeAt(0), 0) + '<br>';
                debugHtml += '授权域名密钥: ' + allowedDomainKey + '<br>';
                
                // 计算当前域名的密钥
                const currentDomainKey = Array.from(currentDomain).reduce((sum, char) => sum + char.charCodeAt(0), 0);
                
                debugHtml += '密钥匹配: ' + (currentDomainKey === allowedDomainKey ? '是' : '否') + '<br>';
                debugHtml += '直接域名匹配: ' + (currentDomain === allowedDomainClean ? '是' : '否') + '<br>';
                
                // 验证域名
                if (currentDomainKey === allowedDomainKey) {
                    // 密钥匹配，允许访问
                    document.getElementById('debugInfo').innerHTML = debugHtml + '<br><span style="color: green;">验证成功！</span>';
                    return true;
                } else {
                    // 显示调试信息
                    document.getElementById('debugInfo').innerHTML = debugHtml + '<br><span style="color: red;">验证失败！</span>';
                    
                    // 也尝试直接比较域名（作为备用验证）
                    if (currentDomain === allowedDomainClean) {
                        document.getElementById('debugInfo').innerHTML += '<br><span style="color: green;">直接域名匹配成功！</span>';
                        return true;
                    }
                    
                    showDomainWarning(currentDomain, allowedDomainClean);
                    return false;
                }
            } catch (e) {
                console.error('域名验证失败:', e);
                document.getElementById('debugInfo').innerHTML = '验证异常: ' + e.message;
                return false;
            }
        }
        
        // 显示域名警告
        function showDomainWarning(current, allowed) {
            const warning = document.getElementById('domainWarning');
            const currentDisplay = document.getElementById('currentDomainDisplay');
            const allowedDisplay = document.getElementById('allowedDomainDisplay');
            
            if (warning && currentDisplay && allowedDisplay) {
                currentDisplay.textContent = current;
                allowedDisplay.textContent = allowed;
                warning.classList.remove('hidden');
                
                // 隐藏其他所有内容
                document.getElementById('decryptPrompt')?.classList.add('hidden');
                document.getElementById('contentContainer')?.classList.add('hidden');
            }
        }
        
        // 支持Unicode的Base64解码函数
        function decodeBase64(base64) {
            try {
                // 将Base64解码为二进制字符串
                const binaryString = atob(base64);
                
                // 将二进制字符串转换为字节数组
                const bytes = new Uint8Array(binaryString.length);
                for (let i = 0; i < binaryString.length; i++) {
                    bytes[i] = binaryString.charCodeAt(i);
                }
                
                // 将UTF-8字节数组解码为字符串
                return new TextDecoder().decode(bytes);
            } catch (e) {
                console.error('Base64解码失败:', e);
                return "";
            }
        }
        
        // 解密函数
        function decryptHTML(encryptedData, key) {
            try {
                // 从base64解码
                const decodedData = decodeBase64(encryptedData);
                if (!decodedData) {
                    return "<p style='color: red;'>解密失败：数据损坏</p>";
                }
                
                // 解密字符
                const decryptedChars = [];
                for (let i = 0; i < decodedData.length; i++) {
                    const charCode = decodedData.charCodeAt(i);
                    // 使用相同的XOR解密
                    const decryptedCode = charCode ^ (key + i % 256);
                    decryptedChars.push(String.fromCharCode(decryptedCode));
                }
                
                return decryptedChars.join('');
            } catch (e) {
                console.error('解密失败:', e);
                return "<p style='color: red;'>解密失败。请检查密码是否正确。</p>";
            }
        }
        
        // 显示原始HTML内容 - 使用document.write完全替换当前文档
        function showOriginalContent() {
            try {
                // 先验证域名
                if (!validateDomain()) {
                    return;
                }
                
                const decryptedHTML = decryptHTML(encryptedData, passwordKey);
                
                // 使用document.write完全替换当前文档
                document.open();
                document.write(decryptedHTML);
                document.close();
            } catch (e) {
                console.error('显示内容失败:', e);
                alert('显示内容失败，请检查密码是否正确');
            }
        }
        
        // 显示源代码
        function showSourceCode(password) {
            try {
                const userKey = Array.from(password).reduce((sum, char) => sum + char.charCodeAt(0), 0);
                
                if (userKey === passwordKey) {
                    const decryptedHTML = decryptHTML(encryptedData, passwordKey);
                    
                    // 创建新窗口显示源代码
                    const sourceWindow = window.open();
                    if (!sourceWindow) {
                        alert('弹出窗口被阻止，请允许弹出窗口后重试');
                        return;
                    }
                    
                    sourceWindow.document.write(
                        '<!DOCTYPE html><html><head><title>HTML源代码</title>' +
                        '<style>body { font-family: monospace; background: #f5f5f5; padding: 20px; } pre { background: white; padding: 20px; border-radius: 5px; overflow: auto; }</style></head>' +
                        '<body><h2>HTML源代码</h2><pre>' + 
                        decryptedHTML
                            .replace(/&/g, '&amp;')
                            .replace(/</g, '&lt;')
                            .replace(/>/g, '&gt;')
                            .replace(/"/g, '&quot;')
                            .replace(/'/g, '&#039;') + 
                        '</pre></body></html>'
                    );
                    sourceWindow.document.close();
                } else {
                    alert('密码错误！');
                }
            } catch (e) {
                console.error('显示源代码失败:', e);
                alert('显示源代码失败');
            }
        }
        
        // 页面加载时自动显示原始内容
        window.addEventListener('DOMContentLoaded', function() {
            showOriginalContent();
        });
        
        // 设置查看源代码按钮事件
        document.addEventListener('DOMContentLoaded', function() {
            // 由于document.write会替换整个文档，我们需要重新获取元素
            setTimeout(function() {
                const sourceBtn = document.getElementById('showSourceBtn');
                const passwordInput = document.getElementById('decryptPassword');
                
                if (sourceBtn && passwordInput) {
                    sourceBtn.addEventListener('click', function() {
                        const password = passwordInput.value;
                        if (password) {
                            showSourceCode(password);
                        } else {
                            alert('请输入密码');
                        }
                    });
                    
                    // 允许按Enter键提交密码
                    passwordInput.addEventListener('keyup', function(event) {
                        if (event.key === 'Enter') {
                            sourceBtn.click();
                        }
                    });
                }
            }, 100);
        });
    </script>
</body>
</html>
